---
title: "draft"
author: "Chupeng Yue"
date: "2023-03-18"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(readr)
sample<-read_csv("general_sample_result.csv")
high<-read_csv("v_tan_500 km_s-result.csv")
```

```{r}
sample$v_tan <- sample$r_med_geo * sin(sample$pm/1000*pi/648000) * 978462
high$v_tan <- high$r_med_geo * sin(high$pm/1000*pi/648000) * 978462
high$Gmag_abs <- high$phot_g_mean_mag - 5 * log10(high$r_med_geo) + 5
sample$Gmag_abs <- sample$phot_g_mean_mag - 5 * log10(sample$r_med_geo) + 5
high$RPmag_abs <- high$phot_rp_mean_mag - 5 * log10(high$r_med_geo) + 5
sample$RPmag_abs <- sample$phot_rp_mean_mag - 5 * log10(sample$r_med_geo) + 5
high$BPmag_abs <- high$phot_bp_mean_mag - 5 * log10(high$r_med_geo) + 5
sample$BPmag_abs <- sample$phot_bp_mean_mag - 5 * log10(sample$r_med_geo) + 5
```


```{r}
library(ggplot2)
data1<-subset(sample,select = c(v_tan,Gmag_abs,RPmag_abs,BPmag_abs,bp_rp,bp_g,g_rp))
data2<-subset(high,select = c(v_tan,Gmag_abs,RPmag_abs,BPmag_abs,bp_rp,bp_g,g_rp))
```

```{r}
data1$group<-"general"
data2$group<-"high"
data1<-na.omit(data1)
data2<-na.omit(data2)


```

```{r}
data3<-rbind(data1, data2)
ggplot(data3, aes(x=v_tan, color=group, fill=group)) +
geom_histogram(aes(y=..density..), position="identity", alpha=0.5)+
geom_density(alpha=0.6)+
labs(title="velocity plot",x="velocity", y = "Density")+
theme_classic()
```

```{r}

ggplot(data3, aes(x=Gmag_abs, color=group, fill=group)) +
geom_histogram(aes(y=..density..), position="identity", alpha=0.5)+geom_density(alpha=.01,) +
labs(title="magnitude(green) plot",x="magnitude", y = "Density")+
theme_classic()
```

```{r}
ggplot(data3, aes(x=RPmag_abs, color=group, fill=group)) +
geom_histogram(aes(y=..density..), position="identity", alpha=0.5)+geom_density(alpha=.01,) +
labs(title="magnitude(red) plot",x="magnitude", y = "Density")+
theme_classic()
```

```{r}
ggplot(data3, aes(x=BPmag_abs, color=group, fill=group)) +
geom_histogram(aes(y=..density..), position="identity", alpha=0.5)+geom_density(alpha=.01,) +
labs(title="magnitude(blue) plot",x="magnitude", y = "Density")+
theme_classic()
```

```{r}
ggplot(data3, aes(x=bp_rp, color=group, fill=group)) +
geom_histogram(aes(y=..density..), position="identity", alpha=0.5)+geom_density(alpha=.01,) +
labs(title="color(blue-red) plot",x="Difference", y = "Density")+
theme_classic()
```

```{r}
ggplot(data3, aes(x=bp_g, color=group, fill=group)) +
geom_histogram(aes(y=..density..), position="identity", alpha=0.5)+geom_density(alpha=.01,) +
labs(title="color(blue-green) plot",x="Difference", y = "Density")+
theme_classic()
```

```{r}
ggplot(data3, aes(x=g_rp, color=group, fill=group)) +
geom_histogram(aes(y=..density..), position="identity", alpha=0.5)+geom_density(alpha=.01,) +
labs(title="color(green-red) plot",x="Difference", y = "Density")+
theme_classic()
```
variance Analysis(Bartlett's test)
```{r}
bartlett.test(list(data1$v_tan,data2$v_tan))
```

Brown-Forsythe's test
```{r}
library(onewaytests)
bf.test(v_tan ~ group, data = data3)
```
According to the graph this data is not normal distribution. according to the bartlett test and Brown-Forsythe's test, variances of this two variables are heterogeneous. Therfore we can not use normal anova analysis tools like t-test or f test.

We choose Kruskal-Wallis Test 
This test is the nonparametric equivalent of the one-way ANOVA and is typically used when the normality assumption is violated.

Kruskal-Wallis Test

```{r}
kruskal.test(v_tan ~ group, data = data3)
```

or we can use Welch test
```{r}
oneway.test(v_tan ~ group, data = data3, var.equal = FALSE)
```
Both test shows that we can reject null hypotheis, there are siginficant different between high group and general group

for other varibale
```{r}
bf.test(Gmag_abs ~ group, data = data3)
```


```{r}
bf.test(RPmag_abs ~ group, data = data3)
```


```{r}
bf.test(BPmag_abs ~ group, data = data3)
```


```{r}
bf.test(bp_rp ~ group, data = data3)
```

```{r}
bf.test(bp_g ~ group, data = data3)
```


```{r}
bf.test(g_rp ~ group, data = data3)
```
```{r}
oneway.test(Gmag_abs ~ group, data = data3, var.equal = FALSE)
```
```{r}
oneway.test(RPmag_abs ~ group, data = data3, var.equal = FALSE)
```


```{r}
oneway.test(BPmag_abs ~ group, data = data3, var.equal = FALSE)
```
```{r}
oneway.test(bp_rp ~ group, data = data3, var.equal = FALSE)
```
```{r}
oneway.test(bp_g ~ group, data = data3, var.equal = FALSE)
```
```{r}
oneway.test(g_rp ~ group, data = data3, var.equal = FALSE)
```


